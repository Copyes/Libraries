!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Gesture",[],e):"object"==typeof exports?exports.Gesture=e():t.Gesture=e()}(this,function(){return function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),h=function(){function t(e){s(this,t),this.eventHandlers=[],this.el=e}return n(t,[{key:"add",value:function(t){this.eventHandlers.push(t)}},{key:"del",value:function(t){t||(this.eventHandlers=[]);for(var e=0;e<this.eventHandlers.length;e++)this.eventHandlers[e]===t&&this.eventHandlers.splice(e,1)}},{key:"dispatch",value:function(){for(var t=0;t<this.eventHandlers.length;t++){var e=this.eventHandlers[t];"function"==typeof e&&e.apply(this.el,arguments)}}}]),t}(),o=function(t,e){var i=new h(t);return i.add(e),i},a=function(){},u=function(){function t(e,i){s(this,t),this.element="string"==typeof e?document.querySelector(e):e,this.startTime=null,this.startX=this.startY=null,this.moveX=this.moveY=null,this.previousTouchPoint=null,this.previousTime=null,this.isDoubleTap=!1,this.tapTimeout=null,this.longPressTimeout=null,this.swipeTimeout=null,this.pinchStartDistance=null,this.touchStartVector=null,this.delta=null,this.touchStart=this.touchStart.bind(this),this.touchMove=this.touchMove.bind(this),this.touchEnd=this.touchEnd.bind(this),this.touchCancel=this.touchCancel.bind(this),this.element.addEventListener("touchstart",this.touchStart,!1),this.element.addEventListener("touchmove",this.touchMove,!1),this.element.addEventListener("touchend",this.touchEnd,!1),this.element.addEventListener("touchcancel",this.touchCancel,!1),this.tap=o(this.element,i.tap||a),this.doubleTap=o(this.element,i.doubleTap||a),this.singleTap=o(this.element,i.singleTap||a),this.longPress=o(this.element,i.longPress||a),this.pinch=o(this.element,i.pinch||a),this.rotate=o(this.element,i.rotate||a),this.swipe=o(this.element,i.swipe||a)}return n(t,[{key:"_getTime",value:function(){return(new Date).getTime()}},{key:"getDistance",value:function(t,e){return Math.sqrt(t*t+e*e)}},{key:"getRotateDirection",value:function(t,e){return t.x*e.y-e.x*t.y}},{key:"getDotValue",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"getRotateAngle",value:function(t,e){var i=this.getRotateDirection(t,e);i=i>0?-1:1;var s=this.getDistance(t.x,t.y),n=this.getDistance(e.x,e.y),h=s*n;if(0===h)return 0;var o=this.getDotValue(t,e),a=o/h;return a>1&&(a=1),a<-1&&(a=-1),Math.acos(a)*i*180/Math.PI}},{key:"getSwipeDirection",value:function(t,e,i,s){return Math.abs(t-e)>=Math.abs(i-s)?t-e>0?"left":"right":i-s>0?"up":"down"}},{key:"checkIsTap",value:function(){return!(null!==this.moveX&&Math.abs(this.moveX-this.startX)>30||null!==this.moveX&&Math.abs(this.moveY-this.startY)>30)}},{key:"checkIsDbTap",value:function(){return Math.abs(this.startX-this.previousTouchPoint.startX)<30&&Math.abs(this.startY-this.previousTouchPoint.startY)<30&&this.delta<300&&this.delta>0}},{key:"touchStart",value:function(t){var e=this;if(!t.touches.length){this._cancelLongPress(),this.now=+Date.now(),this.startX=t.touches[0].pageX,this.startY=t.touches[0].pageY;var i=t.touches.length;if(this.delta=this.now-(this.previousTime||this.now),this.previousTouchPoint&&(this.isDoubleTap=this.checkIsDbTap()),this.previousTime=this.now,this.previousTouchPoint={startX:this.startX,startY:this.startY},i>1){this._cancelLongPress();var s=t.touches[0],n=t.touches[1],h=Math.abs(s.pageX-n.pageX),o=Math.abs(n.pageY-n.pageY);this.pinchStartDistance=this.getDistance(h,o),this.touchStartVector={x:s.pageX-n.pageX,y:n.pageY-n.pageY}}else this.startTime=this._getTime(),this.longPressTimeout=setTimeout(function(){e.longPress.dispatch()},750)}}},{key:"touchMove",value:function(t){this.moveX=t.touches[0].pageX,this.moveY=t.touches[0].pageY,this.isDoubleTap=!1,this._cancelLongPress();var e=t.touches.length;if(e>1){var i=t.touches[0],s=t.touches[1],n=Math.abs(i.pageX-s.pageX),h=Math.abs(s.pageY-s.pageY),o=this.getDistance(n,h);if(this.pinchStartDistance){var a=o/this.pinchStartDistance;t.pinchScale=a,this.pinch.dispatch(t)}if(this.touchStartVector){var u={x:i.pageX-s.pageX,y:s.pageY-s.pageY};this.getRotateAngle(u,this.touchStartVector);this.rotate.dispatch()}}e>1&&t.preventDefault()}},{key:"touchEnd",value:function(t){var e=this;this._getTime();this._cancelLongPress(),this.checkIsTap()?this.tapTimeout=setTimeout(function(){e.tap.dispatch(),e.isDoubleTap&&(e.doubleTap.dispatch(),e.isDoubleTap=!1)},0):(t.direction=this.getSwipeDirection(this.startX,this.moveX,this.startY,this.moveY),this.swipeTimeout=setTimeout(function(){e.swipe.dispatch(t)},0)),this.pinchStartDistance=null,this.startX=this.moveX=this.startY=this.moveY=null}},{key:"touchCancel",value:function(t){clearTimeout(this.longPressTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.swipeTimeout)}},{key:"_cancelLongPress",value:function(){clearTimeout(this.longPressTimeout)}},{key:"_cancelSwipe",value:function(){clearTimeout(this.swipeTimeout)}},{key:"destroyedAll",value:function(){return this.longPressTimeout&&clearTimeout(this.longPressTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.swipeTimeout&&clearTimeout(this.swipeTimeout),this.element.removeEventListener("touchstart",this.touchStart,!1),this.element.removeEventListener("touchmove",this.touchMove,!1),this.element.removeEventListener("touchend",this.touchEnd,!1),this.element.removeEventListener("touchcancel",this.touchCancel,!1),this.rotate.del(),this.swipe.del(),this.tap.del(),this.pinch.del(),this.longPress.del(),this.doubleTap.del(),this.startTime=null,this.startX=this.startY=null,this.moveX=this.moveY=null,this.previousTouchPoint=null,this.previousTime=null,this.isDoubleTap=!1,this.tapTimeout=null,this.longPressTimeout=null,this.swipeTimeout=null,this.pinchStartDistance=null,this.touchStartVector=null,null}}]),t}();t.exports=u}])});